<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.tbs.mapper.UserMapper">

    <resultMap id="userResultMap" type="UserInfo" autoMapping="true">
        <id property="id" column="id"/>
        <collection property="roles"   ofType="Role" javaType="List" autoMapping="true">
            <id property="id" column="rid"/>
        </collection>
    </resultMap>
    <!--查询所有用户信息-->
    <select id="findUserByUserName" resultMap="userResultMap">
        SELECT
            *,r.id rid
        FROM
            users u,
            role r,
            users_role ur
        WHERE
            u.id = ur.userId
          AND
            r.id = ur.roleId
          AND
            u.username = #{s}
    </select>


    <select id="findAllUsers" resultType="cn.tbs.pojo.UserInfo">
        select* from users
    </select>
</mapper>